# ゼウス締め切り監視機能強化 - 実装計画書

## ゴール
`zeus_chat.py` を修正し、Zeusが `data/event_master.json` から「応募締切」を確実に取得し、切迫している場合（7日以内または期限切れ）に最優先で警告するようにする。

## 変更内容

### [MODIFY] [zeus_chat.py](file:///c:/Users/yjing/.gemini/atlas-hub/logic/zeus_chat.py)

#### 1. イベントリストのフォーマット変更
イベントリストの出力形式をユーザー指定の形式に統一する。
- **Before**: `- {name} {status_mark} | 応募締切: {deadline} | 開催: {date_val}`
- **After**: `- {name} | 開催: {date_val} | 応募締切: {deadline} | ステータス: {status}`

#### 2. 締め切り日付のパースと警告判定ロジックの実装
- `deadline` 文字列（YYYY/MM/DD, YYYY-MM-DDなど）をパースし、`datetime` オブジェクトに変換する。
- 現在日時と比較し、以下の条件でフラグを立てる。
    - **期限切れ**: `deadline < now`
    - **切迫（7日以内）**: `0 <= (deadline - now).days <= 7`
- 警告対象が存在する場合、システムプロンプトの冒頭または「最重要事項」セクションに警告メッセージを挿入する。

#### 3. システムプロンプトの指示強化
- 「応募締切の監視」を最優先事項として定義する。
- 警告がある場合は、挨拶よりも先に（あるいは挨拶と同時に）その件に触れるよう指示する。

## 検証計画

### 自動テスト（検証スクリプト）
- ダミーの `event_master.json` データを用意する（期限切れ、7日以内、余裕あり の3パターン）。
- `build_system_prompt` を呼び出し、生成されたプロンプトに以下が含まれているか確認する。
    - 指定されたフォーマットのイベントリスト。
    - 切迫/期限切れイベントに対する警告メッセージ。

### 手動検証
- スクリプトによる出力結果を目視確認する。
